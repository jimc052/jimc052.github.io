webpackJsonp([1],{"+skl":function(e,t){},"6OZ8":function(e,t){},D4On:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Xxa5"),o=n.n(r),a=n("exGp"),i=n.n(a),s=n("//Fk"),c=n.n(s),l=n("7+uW"),p=n("pFYg"),u=n.n(p),f={name:"Report",data:function(){return{project:"",projects:[],columns:[],datas:[],height:300}},created:function(){},mounted:function(){var e=this;return i()(o.a.mark(function t(){var n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.$Spin.show(),e.onResize(),e.broadcast.$on("on-resize",e.onResize),"string"==typeof localStorage["PROJECT-KEY"]&&(e.project=localStorage["PROJECT-KEY"]),t.prev=4,n="select * from jim.PROJECT \n        where DATE_END = '' and\n        (\n          PM like '%"+localStorage["PROJECT-USER"]+"%'\n          or RD like '%"+localStorage["PROJECT-USER"]+"%'\n          or QA like '%"+localStorage["PROJECT-USER"]+"%'\n        )\n        order by PRJ_CODE",t.next=8,e.$fetch(n);case 8:r=t.sent,r=JSON.parse(r),"object"===u()(r.Data)&&(e.projects=r.Data),e.projects.length>0&&e.retrieve(),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(4),console.log(t.t0);case 17:return t.prev=17,setTimeout(function(){e.$Spin.hide()},600),t.finish(17);case 20:case"end":return t.stop()}},t,e,[[4,14,17,20]])}))()},destroyed:function(){this.broadcast.$off("on-resize",this.onResize)},methods:{onResize:function(){var e=this.$refs.frame;this.height=e.clientHeight},retrieve:function(){var e=this;return i()(o.a.mark(function t(){var n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return function(){e.columns=[{type:"index",align:"center",fixed:"left",width:50,className:"index",indexMethod:function(e){return e._index+1}}],""==e.project.trim()&&e.columns.push({title:"專案",key:"PRJ_NAME",width:150,resizable:!0,fixed:"left"}),e.columns=e.columns.concat([{title:"標題",key:"TITLE",resizable:!0,width:200,tooltip:!0},{title:"說明",key:"MEMO",resizable:!0,tooltip:!0},{title:"狀態",key:"STATUS",resizable:!0,width:50},{title:"更新者",key:"USER_UPDATE",resizable:!0,width:100}])}(),e.$Spin.show(),t.prev=3,n="select a.* \n          from jim.REPORT as a\n          where a.PRJ_CODE = '"+e.report+" order by a.PK desc'",t.next=7,e.$fetch(n);case 7:r=t.sent,r=JSON.parse(r),"object"===u()(r.Data)&&(e.projects=r.Data),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),console.log(t.t0);case 15:return t.prev=15,setTimeout(function(){e.$Spin.hide()},600),t.finish(15);case 18:case"end":return t.stop()}},t,e,[[3,12,15,18]])}))()},onChange:function(e){console.log(this.project),localStorage["PROJECT-KEY"]=this.project,this.retrieve()}}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{height:"100%",display:"flex","flex-direction":"column","justify-content":"center","align-items":"stretch",padding:"5px"}},[n("div",{staticStyle:{margin:"5px 0"}},[n("Select",{staticStyle:{width:"150px"},attrs:{size:"large"},on:{"on-change":e.onChange},model:{value:e.project,callback:function(t){e.project=t},expression:"project"}},e._l(e.projects,function(t){return n("Option",{key:t.PRJ_NAME,attrs:{value:t.PRJ_CODE}},[e._v(e._s(t.PRJ_NAME))])}),1)],1),e._v(" "),n("div",{ref:"frame",staticStyle:{flex:"1"}},[n("Table",{attrs:{height:e.height,"highlight-row":"",border:"",stripe:"",columns:e.columns,data:e.datas}})],1)])},staticRenderFns:[]};var h={name:"App",components:{Report:n("VU/8")(f,d,!1,function(e){n("D4On")},"data-v-2d84ff0e",null).exports},data:function(){return{isLog:!1}},created:function(){},mounted:function(){var e=this;return i()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:"string"==typeof localStorage["PROJECT-USER"]?(document.body.style.visibility="visible",window.onresize=function(){e.broadcast.$emit("on-resize")},e.isLog=!0):(window.ondragover=function(e){e.preventDefault(),e.stopPropagation()},window.ondrop=function(e){if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.items)for(var t=e.dataTransfer.items,n=0;n<t.length;n++)if("file"===t[n].kind){var r=t[n].getAsFile();if(r.name.indexOf(".json")>-1){localStorage["PROJECT-USER"]=r.name.replace(".json","");var o=new FileReader;o.onload=function(e){console.log(e.target.result),setTimeout(function(){localStorage["PROJECT-setting"]=e.target.result,location.reload()},600)},o.readAsText(r)}}});case 1:case"end":return t.stop()}},t,e)}))()},methods:{}},g={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[0==this.isLog?t("div",{ref:"dropbox",staticStyle:{height:"inherit"}}):t("Report")],1)},staticRenderFns:[]};var E=n("VU/8")(h,g,!1,function(e){n("6OZ8")},null,null).exports,S=n("BTaQ"),v=n.n(S),m=(n("+skl"),this);l.default.use(v.a),l.default.config.productionTip=!1,l.default.prototype.$setting=null,l.default.prototype.broadcast=new l.default,l.default.prototype.$fetch=function(e){var t,n="GET_SQL",r=e.toUpperCase().trim();if(0!==r.indexOf("INSERT ")&&0!==r.indexOf("DELETE ")&&0!==r.indexOf("UPDATE ")||(n="SET_SQL"),null==m.$setting&&"string"==typeof localStorage["PROJECT-setting"]){var a=JSON.parse(localStorage["PROJECT-setting"]);for(var s in m.$setting={},a)m.$setting[s]=atob(a[s])}return new c.a((t=i()(o.a.mark(function t(r,a){var i,s,c,l;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==m.$setting.SITE){t.next=3;break}return r("[]"),t.abrupt("return");case 3:i=m.$setting.URL+("SET_SQL"===n?"SETDATA_IPAD":"GETDATA_IPAD"),(s=new Headers).append("Content-Type","application/x-www-form-urlencoded"),(c=new URLSearchParams).append("TABLENAME",n),c.append("SITE",m.$setting.SITE),c.append("USERID",m.$setting.USERID),c.append("PASSWORD",m.$setting.PASSWORD),"GET_SQL"===n?(c.append("KeyFilterStr",e),c.append("CAPACITY","1000"),console.log(e)):c.append("DATAFILE",e),c.append("SHOWDEBUG","TRUE"),l={method:"POST",headers:s,body:c,redirect:"follow"},console.log(i),fetch(i,l).then(function(e){return e.text()}).then(function(e){r(e)}).catch(function(e){console.log(e),a(e)});case 16:case"end":return t.stop()}},t,m)})),function(e,n){return t.apply(this,arguments)}))},new l.default({el:"#app",components:{App:E},template:"<App/>",created:function(){var e=this;return i()(o.a.mark(function t(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},t,e)}))()}})}},["NHnr"]);
//# sourceMappingURL=app.js.map