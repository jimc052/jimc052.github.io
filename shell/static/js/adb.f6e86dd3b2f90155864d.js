webpackJsonp([1],{"+skl":function(t,e){},"2x0r":function(t,e){},"4/hK":function(t,e){},"6kY+":function(t,e){},GUiZ:function(t,e){},Sada:function(t,e){},UM8r:function(t,e){},Yokd:function(t,e){},twTI:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("7+uW"),i=n("pFYg"),r=n.n(i),s=n("mvHQ"),a=n.n(s),c=n("Xxa5"),l=n.n(c),d=n("exGp"),p=n.n(d),u=n("bOdI"),f=n.n(u),h=n("E5Az");n("GUiZ"),n("4/hK"),n("UM8r"),n("5IAE"),n("ryyk"),n("4IWT"),n("Yokd"),n("THjC"),n("Kk9m"),n("U3HU"),n("fo6W"),n("soCA");n("aOjs");var m={name:"ModalConfig",props:["visible","config"],components:{codemirror:h.codemirror},data:function(){var t;return{dirty:!1,cmOptions:(t={lineNumbers:!0,mode:"application/json",theme:"monokai",lint:!0,styleActiveLine:!0,matchBrackets:!0},f()(t,"theme","monokai"),f()(t,"autoCloseTags",!0),f()(t,"autofocus",!0),f()(t,"lineWrapping",!0),f()(t,"indentUnit",2),f()(t,"indentWithTabs",!0),f()(t,"smartIndent",!0),f()(t,"tabSize",2),f()(t,"lineWiseCopyCut",!1),f()(t,"foldGutter",!0),f()(t,"lint",!0),f()(t,"gutters",["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"]),t)}},mounted:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},e,t)}))()},methods:{onCmReady:function(t){t.focus(),this.editor=t},onCmFocus:function(t){},onCmCodeChange:function(t){this.dirty=!0},onOK:function(){console.log(this.editor.getValue());try{var t=JSON.parse(this.editor.getValue());this.$emit("on-close",t)}catch(t){}},onVisibleChange:function(t){this.dirty=!1,!1===t&&this.$emit("on-close")}},watch:{visible:function(t){},config:function(t){if(void 0===t)this.editor.setValue("");else{var e=function t(e){var n={};for(var o in e)if(!("nodeKey,expand,selected".indexOf(o)>-1))if(Array.isArray(e[o])){for(var i=[],s=0;s<e[o].length;s++){var a=t(e[o][s]);i.push(a)}n[o]=i}else"string"==typeof e[o]||"number"==typeof e[o]||"boolean"==typeof e[o]?n[o]=e[o]:"object"==r()(e[o])&&(n[o]=t(e[o]));return n}(t);this.editor.setValue(a()(e,null,"\t"))}}}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("modal",{attrs:{id:"modalConfig",title:"配置","class-name":"vertical-center-modal",closable:!1,fullscreen:""},on:{"on-visible-change":t.onVisibleChange},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("codemirror",{ref:"editor",staticStyle:{height:"100%"},attrs:{options:t.cmOptions},on:{ready:t.onCmReady,focus:t.onCmFocus,input:t.onCmCodeChange}}),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("i-button",{attrs:{type:"error"},on:{click:function(e){return t.$emit("on-close")}}},[t._v("取消")]),t._v(" "),t.dirty?n("i-button",{attrs:{type:"primary"},on:{click:t.onOK}},[t._v("確定")]):t._e()],1)],1)},staticRenderFns:[]};var g=n("VU/8")(m,v,!1,function(t){n("6kY+")},null,null).exports,b=n("//Fk"),y=n.n(b),k='<i class="demo-spin-icon-load ivu-icon ivu-icon-ios-loading" style="font-size: 18px; margin-left: 2px;"></i>',w="<span class='term-cursor' />",x={name:"Terminal",components:{},props:["title","height"],data:function(){return{history:"",processing:!1,id:"term"+(new Date).getTime()}},mounted:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.addHistory("cwd","cursor"),t.broadcast.$on("term-execute",t.execute);case 2:case"end":return e.stop()}},e,t)}))()},destroyed:function(){void 0!==this.pid&&window.process.kill(this.pid),this.broadcast.$off("term-execute")},methods:{cwd:function(){var t,e=this;return new y.a((t=p()(l.a.mark(function t(n,o){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:0==e.$isElectron?n("~"):"win32"==window.process.platform||window.child_process.exec("lsof -p "+window.process.pid+" | grep cwd | tr -s ' ' | cut -d ' ' -f9-",function(t,e){n(e.trim())});case 1:case"end":return t.stop()}},t,e)})),function(e,n){return t.apply(this,arguments)}))},execute:function(t,e){var n=this;return p()(l.a.mark(function o(){var i,r;return l.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(t==n.title){o.next=2;break}return o.abrupt("return");case 2:if(console.log(e),"clear"!=e){o.next=8;break}return n.history="",n.addHistory("cwd","cursor"),n.broadcast.$emit("term-finish"),o.abrupt("return");case 8:n.processing=!0,i=e.split("&&"),"",r=0;case 11:if(!(r<i.length)){o.next=23;break}return o.prev=12,o.next=15,n.exeCmd(i[r]);case 15:o.next=20;break;case 17:return o.prev=17,o.t0=o.catch(12),o.abrupt("break",23);case 20:r++,o.next=11;break;case 23:n.processing=!1,n.broadcast.$emit("term-finish");case 25:case"end":return o.stop()}},o,n,[[12,17]])}))()},exeCmd:function(t){var e,n=this;return this.history=this.history.replace(w,""),new y.a((e=p()(l.a.mark(function e(o,i){var r,s,a,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.addHistory(t.trim(),"waiting","\n"),1==n.$isElectron?(r=t.trim().split(" "),s="",a=r[0],r.splice(0,1),c=window.child_process.spawn(a,r),n.pid=c.pid,c.stdout.on("data",function(t){console.log("stdout: "+t.toString()),n.addHistory(t.toString())}),c.stderr.on("data",function(){var t=p()(l.a.mark(function t(e){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:window.process.kill(c.pid),n.pid=void 0,i(e.toString()),n.history=n.history.replace(k,""),n.addHistory({error:e.toString()}),n.addHistory("\n","cwd","cursor");case 6:case"end":return t.stop()}},t,n)}));return function(e){return t.apply(this,arguments)}}()),c.on("exit",function(){var t=p()(l.a.mark(function t(e){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:void 0!==n.pid&&(n.history=n.history.replace(k,""),n.pid=void 0,console.log("exit......."),o(s),n.addHistory("cwd","cursor"));case 1:case"end":return t.stop()}},t,n)}));return function(e){return t.apply(this,arguments)}}())):o();case 2:case"end":return e.stop()}},e,n)})),function(t,n){return e.apply(this,arguments)}))},addHistory:function(){for(var t=this,e=0;e<arguments.length;e++)console.log(e+": '"+arguments[e]+"'"),"string"==typeof arguments[e].error?this.history+="<span class='term-error' >"+arguments[e].error+"</span>":"cwd"==arguments[e]?this.history+="<span class='term-cwd' >~ $ </span>":"cursor"==arguments[e]?this.history+=w:"waiting"==arguments[e]?this.history+=k:this.history+="<span>"+arguments[e].replace(new RegExp("\n","gm"),"<br/>")+"</span>";setTimeout(function(){t.$refs.term.scrollTop=t.$refs.term.scrollHeight},300)}},watch:{}},C={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"term-frame",style:{height:this.height+"px",position:"relative"}},[e("div",{ref:"term",staticClass:"term",attrs:{id:this.id},domProps:{innerHTML:this._s(this.history)}},[this._v("\n    "+this._s(this.history)+"\n  ")])])},staticRenderFns:[]};var j=n("VU/8")(x,C,!1,function(t){n("xloE")},null,null).exports,S={name:"ModalProject",props:["list"],components:{},data:function(){return{columns:[{title:"專案",key:"project"}]}},mounted:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},e,t)}))()},methods:{onRowClick:function(t,e){this.$emit("rowClick",t)}}},_={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"modalProject"}},[e("Table",{attrs:{border:"",columns:this.columns,data:this.list},on:{"on-row-click":this.onRowClick}})],1)},staticRenderFns:[]};var $=n("VU/8")(S,_,!1,function(t){n("2x0r")},null,null).exports,T=!1,E={name:"ADB",components:{ModalConfig:g,Terminal:j},data:function(){return{split1:.3,visible:!1,tabs:[{title:"1",id:1}],tabIndex:1,tabCurr:"1",height:0,project:null,config:{projects:[{project:"BiPOS",package:"com.bipos",folder:"~/Documents/Project/BiPOS2",apk:"/release/BiPOS2-release.apk"},{project:"mECR",package:"com.bethel.v1",folder:"~/react-native/V1/android",apk:"/app/build/outputs/apk/mECR.apk"},{project:"KONE",package:"com.jabezpos.kone",folder:"~/react-native/kone/android",apk:"/app/build/outputs/apk/release/KONE.apk"},{project:"JabezDC",package:"com.jabezdc",folder:"~/react-native/jabezdc/android",apk:"/app/build/outputs/apk/release/JabezDC.apk"}],database:[{title:"資料庫設定",expand:!0,children:[{title:"正式區",role:"database"},{title:"測試區",role:"database"},{title:"77區",role:"database"}]}],commands:[{title:"app 專案",icon:"logo-android",expand:!0,children:[{title:"開啟資料夾",cmd:"open {project.folder}"},{title:"安裝專案",cmd:"adb install -r {project.folder}{project.apk}"},{title:"啓動專案",cmd:"adb shell am start {project.package}/{project.package}.MainActivity"},{title:"停止專案",cmd:"adb shell am force-stop {project.package}"},{title:"移除專案",cmd:"adb shell pm uninstall -k {project.package}"}]},{title:"ADB",expand:!0,children:[{title:"reverse(8081)",cmd:"adb reverse tcp:8081 tcp:8081"},{title:"擷取畫面",cmd:"adb shell screencap -p /sdcard/Download/screencap.png && adb pull /sdcard/Download/screencap.png ~/Downloads && open ~/Downloads && adb shell rm /sdcard/Download/screencap.png"}]},{title:"資料庫複製",icon:"md-redo",role:"database-replicate"},{title:"清除終端機",role:"clear"}]}}},mounted:function(){var t=this;return p()(l.a.mark(function e(){var n,o,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:void 0===(n=localStorage["adb-split-left-width"])&&(n=300),t.split1=1-(document.body.clientWidth-n)/document.body.clientWidth,t.$isElectron,"string"==typeof(o=localStorage["adb-config"])&&o.length>0&&(t.config=JSON.parse(o)),"string"==typeof(o=localStorage["adb-project"])&&o.length>0&&1==(i=t.config.projects.filter(function(t){return t.project==o})).length&&(t.project=i[0]),t.broadcast.$on("on-resize",t.onResize),t.onResize(),t.broadcast.$on("term-finish",t.executeFinish);case 11:case"end":return e.stop()}},e,t)}))()},destroyed:function(){this.broadcast.$off("on-resize",this.onResize),this.broadcast.$off("term-finish",this.executeFinish)},methods:{onMoveEnd:function(){var t=document.querySelector(".left-pane").clientWidth;localStorage["adb-split-left-width"]=t},onResize:function(){var t=document.querySelector(".ivu-tabs").clientHeight,e=document.querySelector(".ivu-tabs-bar").clientHeight;this.height=t-e,document.querySelector(".ivu-tabs-content").style.height=this.height+"px"},onClickIcon:function(){alert("還沒寫，只作測試用，"+this.tabCurr)},onCloseConfig:function(t){void 0!==t&&(localStorage["adb-config"]=a()(t),this.config=t),this.visible=!1},onSelectChange:function(t){var e=this;if(1!=T)for(var n in void 0===t.children&&("string"==typeof t.cmd&&t.cmd.trim().length>0?t.cmd.indexOf("{project.")>-1?null==this.project?this.projectPicker(function(){l(t.cmd)}):l(t.cmd):c(t.cmd):"string"==typeof t.role&&("clear"==t.role?c(t.role):alert("role: "+t.role))),this.config.commands){var o=this.config.commands[n];if("object"==r()(o.children))for(var i=this.config.commands[n].children,s=0;s<i.length;s++){var a=i[s];"object"==r()(a.children)||("boolean"==typeof a.selected?t.nodeKey!=a.nodeKey&&(a.selected=void 0,this.$set(this.config.commands[n].children,s,a)):t.nodeKey==a.nodeKey&&(a.selected=!0,this.$set(this.config.commands[n].children,s,a)))}else"boolean"==typeof o.selected?t.nodeKey!=o.nodeKey&&(o.selected=void 0,this.$set(this.config.commands,n,this.config.commands[n])):t.nodeKey==o.nodeKey&&(o.selected=!0,this.$set(this.config.commands,n,this.config.commands[n]))}function c(t){t=t.replace(new RegExp("~/","gm"),"/Users/"+window.process.env.USER+"/"),T=!0,e.broadcast.$emit("term-execute",e.tabCurr,t)}function l(t){for(var n in e.project)"project"!=n&&(t=t.replace(new RegExp("{project."+n+"}","gm"),e.project[n]));c(t)}},projectPicker:function(t){var e=this;this.$Modal.info({title:"專案清單",width:300,render:function(n){return n($,{props:{list:e.config.projects},on:{rowClick:function(n){e.project=n,localStorage["adb-project"]=n.project,"function"==typeof t&&t(),e.$Modal.remove()}}})}})},executeFinish:function(){T=!1},onTabRemove:function(t){for(var e=0;e<this.tabs.length;e++)if(this.tabs[e].title==t){e==this.tabs.length-1?this.tabCurr=this.tabs[e-1].title:this.tabCurr=this.tabs[e+1].title,this.tabs.splice(e,1);break}},onTabsAdd:function(){++this.tabIndex,this.tabs.push({title:this.tabIndex.toString(),id:this.tabIndex})},onTabClick:function(t){this.tabCurr=t,console.log("onTabClick: ",t)},renderTreeItem:function(t,e){var n=this,o=(e.root,e.node,e.data),i=[t("span",{class:"ivu-tree-title"+(1==o.selected?" ivu-tree-title-selected":""),on:{click:function(){n.onSelectChange(o)}}},o.title)];return i.unshift(t("Icon",{props:{type:"string"==typeof o.icon?o.icon:void 0===o.children?"ios-paper-outline":1==o.expand?"ios-folder-open":"md-folder"},style:{marginRight:"2px"}})),t("span",{style:{display:"inline-block",width:"100%",marginBottom:"0px"}},i)}}},R={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"stretch","justify-content":"end"},attrs:{id:"app"}},[n("div",{staticStyle:{background:"#2d8cf0",display:"flex","flex-direction":"row","justify-content":"start","align-items":"center"}},[n("div",{staticStyle:{flex:"1","text-align":"left",color:"white",padding:"5px"}},[t._v("\n      "+t._s("指令集")+"\n      "),null!=t.project?n("span",{staticStyle:{cursor:"pointer"},on:{click:t.projectPicker}},[t._v("\n        "+t._s("["+t.project.project+"]")+"\n      ")]):t._e()]),t._v(" "),n("Icon",{staticClass:"btn",attrs:{type:"md-cog"},nativeOn:{click:function(e){t.visible=!0}}}),t._v(" "),n("Icon",{staticClass:"btn",attrs:{type:"md-close"},nativeOn:{click:function(e){return t.onClickIcon(e)}}})],1),t._v(" "),n("div",{staticStyle:{flex:"1"}},[n("Split",{on:{"on-move-end":t.onMoveEnd},model:{value:t.split1,callback:function(e){t.split1=e},expression:"split1"}},[n("div",{staticClass:"demo-split-pane",staticStyle:{"z-index":"1","overflow-x":"hidden"},attrs:{slot:"left",id:"left"},slot:"left"},[n("Tree",{staticStyle:{"z-index":"-1"},attrs:{data:t.config.commands.concat(t.config.database),render:t.renderTreeItem},on:{"on-select-change":t.onSelectChange}})],1),t._v(" "),n("div",{staticClass:"demo-split-pane",staticStyle:{"z-index":"1","overflow-x":"hidden"},attrs:{slot:"right",id:"right"},slot:"right"},[n("Tabs",{attrs:{type:"card"},on:{"on-tab-remove":t.onTabRemove,"on-click":t.onTabClick}},[t._l(t.tabs,function(e,o){return n("TabPane",{key:e.id,attrs:{closable:0!=o,name:e.title,label:"Shell "+e.title}},[n("Terminal",{ref:"term-"+e.title,refInFor:!0,attrs:{height:t.height,title:e.title}})],1)}),t._v(" "),n("Button",{attrs:{slot:"extra",size:"small"},on:{click:t.onTabsAdd},slot:"extra"},[t._v("增加")])],2)],1)])],1),t._v(" "),n("ModalConfig",{ref:"modal",attrs:{visible:t.visible,config:0==t.visible?void 0:t.config},on:{"on-close":t.onCloseConfig}})],1)},staticRenderFns:[]};var z=n("VU/8")(E,R,!1,function(t){n("Sada")},null,null).exports,O=n("BTaQ"),I=n.n(O),K=(n("+skl"),n("4lpq"));o.default.use(I.a,{locale:K.a}),o.default.config.productionTip=!1,o.default.prototype.broadcast=new o.default,o.default.prototype.$isElectron=navigator.userAgent.indexOf("Electron")>-1,new o.default({el:"#app",components:{ADB:z},template:"<ADB />",mounted:function(){var t=this;window.onresize=function(){t.broadcast.$emit("on-resize")}}})},xloE:function(t,e){}},["twTI"]);
//# sourceMappingURL=adb.f6e86dd3b2f90155864d.js.map