webpackJsonp([1],{"+skl":function(e,t){},"2x0r":function(e,t){},"3XKM":function(e,t){},"4/hK":function(e,t){},GUiZ:function(e,t){},"Qp2+":function(e,t){},UM8r:function(e,t){},YLLs:function(e,t){},Yokd:function(e,t){},eBcB:function(e,t){},twTI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7+uW"),o=n("pFYg"),i=n.n(o),a=n("mvHQ"),s=n.n(a),c=n("Xxa5"),l=n.n(c),d=n("exGp"),u=n.n(d),p={name:"ModalDatabaseOption",props:["visible","config"],data:function(){return{mode:"複製",tables:["系統資料表","基本資料表"],database:[],sql_var:[],target:"",source:""}},mounted:function(){var e=this;return u()(l.a.mark(function t(){var n,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof(n=localStorage["adb-database-option"])&&n.length>0)for(r in n=JSON.parse(n))e[r]=n[r];case 2:case"end":return t.stop()}},t,e)}))()},methods:{onOK:function(){var e=this,t={mode:this.mode,tables:this.tables,sql_var:this.sql_var,target:this.target,source:this.source};"複製"==this.mode&&0==this.source.length?alert("請選擇 Source"):0==this.target.length?alert("請選擇 Target"):0==this.sql_var[0].value.length?alert("請輸入 SITE"):(localStorage["adb-database-option"]=s()(t),t.source_config=this.database.filter(function(t){return t.title==e.source})[0],t.target_config=this.database.filter(function(t){return t.title==e.target})[0],this.$emit("on-close",t))},onVisibleChange:function(e){if(!1===e)this.$emit("on-close");else{var t=localStorage["adb-config"];if("string"==typeof t&&t.length>0){var n=JSON.parse(t).database.filter(function(e){return"object"==i()(e.children)});if(n.length>0){var r=["host","user","password","database","sys_database"],o=n[0].children.filter(function(e){if("database"==e.role){for(var t=0;t<r.length;t++)if(void 0===e[r[t]]||0==e[r[t]].length)return!1;return!0}return!1});o.forEach(function(e){e.security=e.host.trim().toLowerCase().indexOf("myjabezpos")>-1&&(0==e.database.trim().toLowerCase().indexOf("jp_")||0==e.sys_database.trim().toLowerCase().indexOf("jp_"))}),this.database=o,0==o.length&&alert("請先設定資料庫")}}}}},watch:{visible:function(e){},source:function(e){e.length>0&&this.target==e&&(this.target="")},config:function(e){var t=this;if("object"==(void 0===e?"undefined":i()(e))){var n=localStorage["adb-database-option"];n="string"==typeof n&&n.length>0?JSON.parse(n).sql_var:[],this.sql_var=[{title:"SITE",value:""}],Array.isArray(e.sql_var)&&(e.sql_var.forEach(function(e){t.sql_var.push({title:e,value:""})}),this.sql_var.forEach(function(e){var t=n.find(function(t){return t.title==e.title});void 0!==t&&t.value.trim().length>0&&(e.value=t.value.trim())}))}}}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{attrs:{id:"modalDatatbaseOption",title:"資料庫複製","class-name":"vertical-center-modal",closable:!1},on:{"on-visible-change":e.onVisibleChange},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("div",[n("div",{staticStyle:{margin:"10px 0px"}},[n("RadioGroup",{attrs:{type:"button"},model:{value:e.mode,callback:function(t){e.mode=t},expression:"mode"}},[n("Radio",{attrs:{label:"複製"}}),e._v(" "),n("Radio",{attrs:{label:"刪除"}})],1)],1),e._v(" "),"複製"==e.mode?n("div",{staticStyle:{margin:"10px 0px"}},[n("CheckboxGroup",{model:{value:e.tables,callback:function(t){e.tables=t},expression:"tables"}},[n("Checkbox",{attrs:{label:"系統資料表",border:"",disabled:""}}),e._v(" "),n("Checkbox",{attrs:{label:"基本資料表",border:"",disabled:""}}),e._v(" "),n("Checkbox",{attrs:{label:"交易資料表",border:""}}),e._v(" "),n("Checkbox",{attrs:{label:"自訂資料表",border:""}})],1)],1):e._e(),e._v(" "),n("div",{staticStyle:{margin:"10px 0px",display:"flex","flex-direction":"row","justify-content":"start","align-items":"center"}},["複製"==e.mode?n("div",[e._v("Source：")]):e._e(),e._v(" "),"複製"==e.mode?n("Select",{model:{value:e.source,callback:function(t){e.source=t},expression:"source"}},e._l(e.database,function(t){return n("Option",{key:t.title,attrs:{value:t.title}},[e._v("\n          "+e._s(t.title)+"\n        ")])}),1):e._e(),e._v(" "),n("div",{staticStyle:{"margin-left":"5px"}},[e._v("Target：")]),e._v(" "),n("Select",{model:{value:e.target,callback:function(t){e.target=t},expression:"target"}},e._l(e.database,function(t){return 0==t.security&&t.title!=e.source?n("Option",{key:t.title,attrs:{value:t.title}},[e._v("\n          "+e._s(t.title)+"\n        ")]):e._e()}),1)],1),e._v(" "),e._l(e.sql_var,function(t,r){return n("div",{key:t.title},["複製"==e.mode||"刪除"==e.mode&&0==r?n("div",{staticClass:"row"},[e._v("\n        "+e._s(t.title+"：")+"\n        "),n("Input",{attrs:{size:"large",clearable:""},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"item.value"}})],1):e._e()])})],2),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("i-button",{attrs:{type:"error"},on:{click:function(t){return e.$emit("on-close")}}},[e._v("取消")]),e._v(" "),n("i-button",{attrs:{type:"primary"},on:{click:e.onOK}},[e._v("確定")])],1)])},staticRenderFns:[]};var h=n("VU/8")(p,f,!1,function(e){n("YLLs")},null,null).exports,m={name:"ModalDatabasePicker",props:["database","cols"],components:{},data:function(){return{}},mounted:function(){var e=this;return u()(l.a.mark(function t(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},t,e)}))()},methods:{onChange:function(e){this.$emit("onChange",this.database)}}},b={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("table",{staticStyle:{width:"100%"}},e._l(e.cols,function(t){return n("tr",{key:t.key},[n("td",{staticStyle:{"text-align":"right",width:"100px"}},[e._v(e._s(t.title+"："))]),e._v(" "),n("td",[n("Input",{attrs:{id:"host",size:"large",clearable:""},on:{"on-change":e.onChange},model:{value:e.database[t.key],callback:function(n){e.$set(e.database,t.key,n)},expression:"database[item.key]"}})],1)])}),0)])},staticRenderFns:[]};var v=n("VU/8")(m,b,!1,function(e){n("zql2")},null,null).exports,g=n("bOdI"),_=n.n(g),y=n("E5Az");n("GUiZ"),n("4/hK"),n("UM8r"),n("5IAE"),n("ryyk"),n("4IWT"),n("Yokd"),n("THjC"),n("Kk9m"),n("U3HU"),n("fo6W"),n("soCA");n("aOjs");var S={name:"ModalConfig",props:["visible","config"],components:{codemirror:y.codemirror},data:function(){var e;return{dirty:!1,cmOptions:(e={lineNumbers:!0,mode:"application/json",theme:"monokai",lint:!0,styleActiveLine:!0,matchBrackets:!0},_()(e,"theme","monokai"),_()(e,"autoCloseTags",!0),_()(e,"autofocus",!0),_()(e,"lineWrapping",!0),_()(e,"indentUnit",2),_()(e,"indentWithTabs",!0),_()(e,"smartIndent",!0),_()(e,"tabSize",2),_()(e,"lineWiseCopyCut",!1),_()(e,"foldGutter",!0),_()(e,"lint",!0),_()(e,"gutters",["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"]),e),height:0}},mounted:function(){var e=this;return u()(l.a.mark(function t(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},t,e)}))()},methods:{onCmReady:function(e){e.focus(),this.editor=e},onCmFocus:function(e){},onCmCodeChange:function(e){this.dirty=!0},onOK:function(){try{var e=JSON.parse(this.editor.getValue());this.$emit("on-close",e)}catch(e){}},onVisibleChange:function(e){this.dirty=!1,!1===e&&this.$emit("on-close")},onResize:function(){var e=document.querySelector("#modalConfig .ivu-modal-body").clientHeight;this.height=e,document.querySelector(".CodeMirror").style.height=e+"px",console.log("CodeMirror.clientHeight: "+document.querySelector(".CodeMirror").clientHeight)}},watch:{visible:function(e){var t=this;1==e?setTimeout(function(){t.onResize()},600):this.height=0},config:function(e){if(void 0===e)this.editor.setValue("");else{var t=function e(t){var n={};for(var r in t)if(!("nodeKey,expand,selected".indexOf(r)>-1))if("tables"==r||"projects"==r||"sql_var"==r||"string"==typeof t[r]||"number"==typeof t[r]||"boolean"==typeof t[r])n[r]=t[r];else if(Array.isArray(t[r])){for(var o=[],a=0;a<t[r].length;a++){var s=e(t[r][a]);o.push(s)}n[r]=o}else"object"==i()(t[r])&&(n[r]=e(t[r]));return n}(e);this.editor.setValue(s()(t,null,"\t"))}}}},k={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{attrs:{id:"modalConfig",title:"配置","class-name":"vertical-center-modal",closable:!1,fullscreen:""},on:{"on-visible-change":e.onVisibleChange},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("codemirror",{ref:"editor",style:{height:e.height+"px"},attrs:{options:e.cmOptions},on:{ready:e.onCmReady,focus:e.onCmFocus,input:e.onCmCodeChange}}),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("i-button",{attrs:{type:"error"},on:{click:function(t){return e.$emit("on-close")}}},[e._v("取消")]),e._v(" "),e.dirty?n("i-button",{attrs:{type:"primary"},on:{click:e.onOK}},[e._v("確定")]):e._e()],1)],1)},staticRenderFns:[]};var x=n("VU/8")(S,k,!1,function(e){n("eBcB")},null,null).exports,T=n("//Fk"),C=n.n(T),w='<i class="demo-spin-icon-load ivu-icon ivu-icon-ios-loading"></i>',O="<span class='term-cursor' />",E="shell",P={name:"Terminal",components:{},props:["title","height"],data:function(){return{history:"",processing:!1,id:"term"+(new Date).getTime()}},mounted:function(){var e=this;return u()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.addHistory("cwd","cursor"),e.broadcast.$on("term-execute",function(t,n){t==e.title&&("shell"!=E&&(e.history="",document.getElementById(e.id).innerHTML=""),setTimeout(function(){"shell"!=E&&e.addHistory("cwd","cursor"),e.execute(t,n)},"shell"!=E?600:0))}),e.broadcast.$on("term-database",function(t,n){t==e.title&&(e.history="",document.getElementById(e.id).innerHTML="",setTimeout(function(){e.database(t,n)},600))});case 3:case"end":return t.stop()}},t,e)}))()},destroyed:function(){void 0!==this.pid&&window.process.kill(this.pid),this.broadcast.$off("term-execute"),this.broadcast.$off("term-database")},methods:{cwd:function(){var e,t=this;return new C.a((e=u()(l.a.mark(function e(n,r){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:0==t.$isElectron?n("~"):"win32"==window.process.platform||window.child_process.exec("lsof -p "+window.process.pid+" | grep cwd | tr -s ' ' | cut -d ' ' -f9-",function(e,t){n(t.trim())});case 1:case"end":return e.stop()}},e,t)})),function(t,n){return e.apply(this,arguments)}))},execute:function(e,t){var n=this;return u()(l.a.mark(function e(){var r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(E="shell",console.log(t),"clear"!=t){e.next=7;break}return n.history="",n.addHistory("cwd","cursor"),n.broadcast.$emit("term-finish"),e.abrupt("return");case 7:n.processing=!0,r=t.split("&&"),"",o=0;case 10:if(!(o<r.length)){e.next=22;break}return e.prev=11,e.next=14,n.exeCmd(r[o]);case 14:e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(11),e.abrupt("break",22);case 19:o++,e.next=10;break;case 22:n.processing=!1,n.broadcast.$emit("term-finish");case 24:case"end":return e.stop()}},e,n,[[11,16]])}))()},database:function(e,t){var n=this;return u()(l.a.mark(function e(){var r,o,a,c,d,p,f,h,m,b,v,g,_,y,S,k,x,T,w,O,P,R,A,I,M,j,D,U,L,N;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(N=function(){r.addPrompt("結束："+(new Date).toString()),r.processing=!1,r.broadcast.$emit("term-finish")},L=function(e,t){var n,o=this;return new C.a((n=u()(l.a.mark(function n(i,a){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:1==r.$isElectron?e.query(t,function(e,t,n){e?a(e):setTimeout(function(){i({rows:t,fields:n})},600)}):setTimeout(function(){i("error test")},1e3);case 1:case"end":return n.stop()}},n,o)})),function(e,t){return n.apply(this,arguments)}))},U=function(e){var t,n=this;return new C.a((t=u()(l.a.mark(function t(o,i){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:1==r.$isElectron?(a=window.mysql.createConnection(e)).connect(function(e){e?i(e):o(a)}):setTimeout(function(){o("error test")},1e3);case 1:case"end":return t.stop()}},t,n)})),function(e,n){return t.apply(this,arguments)}))},E="database",r=n,n.processing=!0,t.site=t.sql_var[0].value,t.sql_var.splice(0,1),console.log(t),n.addPrompt("開始："+(new Date).toString()),o=void 0,a=void 0,"複製"!=t.mode){e.next=26;break}return e.prev=12,n.addPrompt({id:"source_connect",msg:t.source+"連線中"}),e.next=16,U(t.source_config);case 16:a=e.sent,n.addPrompt({id:"source_connect",msg:t.source+"已連線"}),e.next=26;break;case 20:return e.prev=20,e.t0=e.catch(12),n.addPrompt({id:"source_connect",msg:t.source+"連線失敗!!"}),n.addPrompt({error:e.t0.toString()}),N(),e.abrupt("return");case 26:return e.prev=26,n.addPrompt({id:"target_connect",msg:t.target+"連線中"}),e.next=30,U(t.target_config);case 30:o=e.sent,n.addPrompt({id:"target_connect",msg:t.target+"已連線"}),console.log(o),e.next=41;break;case 35:return e.prev=35,e.t1=e.catch(26),n.addPrompt({id:"target_connect",msg:t.target+"連線失敗!!"}),n.addPrompt({error:e.t1.toString()}),N(),e.abrupt("return");case 41:for(c in t.tables)for(d=t.tables[c],p=d.length-1;p>=0;p--)"object"==(void 0===(f=d[p])?"undefined":i()(f))&&"boolean"==typeof f.disable&&1==f.disable&&d.splice(p,1);if("複製"!=t.mode){e.next=106;break}h={},r.addPrompt(t.source+"資料表複製："+t.site),e.t2=l.a.keys(t.tables);case 46:if((e.t3=e.t2()).done){e.next=65;break}m=e.t3.value,b=t.tables[m],v=l.a.mark(function e(r){var o,c,d,u,p;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=b[r],c="","object"!=(void 0===o?"undefined":i()(o))){e.next=10;break}if("string"!=typeof o.tbl){e.next=7;break}"string"==typeof o.where&&o.where.trim().length>0&&(0==(d=o.where.toUpperCase()).indexOf("AND ")||0==d.indexOf("OR ")||0==d.indexOf("ORDER BY")||0==d.indexOf("LIMIT ")||(c=" and "+o.where),t.sql_var.forEach(function(e){c=c.replace("{"+e.title+"}",e.value)})),o=o.tbl,e.next=10;break;case 7:return console.log("表格參數不正確",o),n.addPrompt({error:"表格參數不正確<br/>"+s()(o)}),e.abrupt("return","break");case 10:return e.prev=10,n.addPrompt({id:"source_"+o,msg:"讀取 "+o+" ......"}),u="Select * from "+("SYS"==m?t.source_config.sys_database+".":"")+o+" Where "+("USERGROUPS"==o?"USERID Like Concat('%@','"+t.site+"')":"SITE = '"+t.site+"'")+c,console.log(u),e.next=16,L(a,u);case 16:(p=e.sent).rows.length>0&&(void 0===h[m]&&(h[m]={}),h[m][o]=p.rows),n.addPrompt({id:"source_"+o,msg:"讀取 "+o+"；"+p.rows.length+" 列"}),e.next=26;break;case 21:return e.prev=21,e.t0=e.catch(10),n.addPrompt({error:e.t0.toString()}),N(),e.abrupt("return",{v:void 0});case 26:case"end":return e.stop()}},e,n,[[10,21]])}),g=0;case 51:if(!(g<b.length)){e.next=63;break}return e.delegateYield(v(g),"t4",53);case 53:_=e.t4,e.t5=_,e.next="break"===e.t5?57:58;break;case 57:return e.abrupt("break",63);case 58:if("object"!==(void 0===_?"undefined":i()(_))){e.next=60;break}return e.abrupt("return",_.v);case 60:g++,e.next=51;break;case 63:e.next=46;break;case 65:a.end(),r.addPrompt(t.target+"資料表寫入："+t.site),e.t6=l.a.keys(h);case 68:if((e.t7=e.t6()).done){e.next=103;break}y=e.t7.value,S=h[y],e.t8=l.a.keys(S);case 72:if((e.t9=e.t8()).done){e.next=101;break}k=e.t9.value,n.addPrompt({id:"target_"+k,msg:"寫入 "+k}),x=0;case 76:if(!(x<S[k].length)){e.next=98;break}for(P in x>0&&n.addPrompt({id:"target_"+k,msg:"寫入 "+k+": "+(x+1)+" / "+S[k].length}),T="",e.prev=79,T="Insert Into "+("SYS"==y?t.target_config.sys_database+".":"")+k+" Set ",w=S[k][x],O="",w)null!=w[P]&&(R="string"==typeof w[P]?w[P].replace(new RegExp("'","gm"),"''"):w[P],O+=(O.length>0?", ":"")+P+"='"+R+"'");return T+=O,e.next=87,L(o,T);case 87:e.sent,e.next=95;break;case 90:return e.prev=90,e.t10=e.catch(79),n.addPrompt({error:T+"<br/>"+e.t10.toString()}),N(),e.abrupt("return");case 95:x++,e.next=76;break;case 98:n.addPrompt({id:"target_"+k,msg:"寫入 "+k+": "+S[k].length+" 列"}),e.next=72;break;case 101:e.next=68;break;case 103:o.end(),e.next=143;break;case 106:r.addPrompt(t.target+"資料表刪除："+t.site),e.t11=l.a.keys(t.tables);case 108:if((e.t12=e.t11()).done){e.next=142;break}A=e.t12.value,I=t.tables[A],M=0;case 112:if(!(M<I.length)){e.next=140;break}if("object"!=(void 0===(j=I[M])?"undefined":i()(j))){e.next=122;break}if("string"!=typeof j.tbl){e.next=119;break}j=j.tbl,e.next=122;break;case 119:return console.log("表格參數不正確",j),n.addPrompt({error:"表格參數不正確<br/>"+s()(j)}),e.abrupt("break",140);case 122:return e.prev=122,n.addPrompt({id:"target_"+j,msg:"刪除 "+j+" ......"}),D="Delete from "+("SYS"==A?t.target_config.sys_database+".":"")+j+" Where "+("USERGROUPS"==j?"USERID Like Concat('%@','"+t.site+"')":"SITE = '"+t.site+"'"),console.log(D),e.next=128,L(o,D);case 128:e.sent,n.addPrompt({id:"target_"+j,msg:"刪除 "+j}),e.next=137;break;case 132:return e.prev=132,e.t13=e.catch(122),n.addPrompt({error:e.t13.toString()}),N(),e.abrupt("return");case 137:M++,e.next=112;break;case 140:e.next=108;break;case 142:o.end();case 143:N();case 144:case"end":return e.stop()}},e,n,[[12,20],[26,35],[79,90],[122,132]])}))()},exeCmd:function(e){var t,n=this;return this.history=this.history.replace(O,""),new C.a((t=u()(l.a.mark(function t(r,o){var i,a,s,c;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.addHistory(e.trim(),"waiting","\n"),1==n.$isElectron?(i=e.trim().split(" "),a="",s=i[0],i.splice(0,1),c=window.child_process.spawn(s,i),n.pid=c.pid,c.stdout.on("data",function(e){console.log("stdout: "+e.toString()),n.addHistory(e.toString())}),c.stderr.on("data",function(){var e=u()(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.process.kill(c.pid),n.pid=void 0,o(t.toString()),n.history=n.history.replace(w,""),n.addHistory({error:t.toString()}),n.addHistory("\n","cwd","cursor");case 6:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}()),c.on("exit",function(){var e=u()(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==n.pid&&(n.history=n.history.replace(w,""),n.pid=void 0,console.log("exit......."),r(a),n.addHistory("cwd","cursor"));case 1:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}())):(n.history=n.history.replace(w,""),n.addHistory("cwd","cursor"),r());case 2:case"end":return t.stop()}},t,n)})),function(e,n){return t.apply(this,arguments)}))},addHistory:function(){for(var e=this,t=0;t<arguments.length;t++)"string"==typeof arguments[t].error?(this.history.replace(w,""),this.history+="<span class='term-error' >"+arguments[t].error+"</span>"):"cwd"==arguments[t]?this.history+="<span class='tem-prompt' >~ $ </span>":"cursor"==arguments[t]?this.history+=O:"waiting"==arguments[t]?this.history+=w:this.history+="<span>"+arguments[t].replace(new RegExp("\n","gm"),"<br/>")+"</span>";setTimeout(function(){e.$refs.term.scrollTop=e.$refs.term.scrollHeight},300)},addPrompt:function(e){var t=this;if("string"==typeof e.id){var n=document.querySelector("#"+this.id+" ."+e.id);if(null==n){var r=document.createElement("div");r.innerHTML="<span class='tem-prompt' >SQL > </span><span class='"+e.id+"'>"+e.msg+w+"</span",document.getElementById(this.id).appendChild(r)}else n.innerHTML=e.msg}else if("string"==typeof e.error){var o=document.createElement("div");o.innerHTML="<span class='term-error' >"+e.error+"</span>",document.getElementById(this.id).appendChild(o)}else if("string"==typeof e){var i=document.createElement("div");i.innerHTML=e,document.getElementById(this.id).appendChild(i)}setTimeout(function(){t.$refs.term.scrollTop=t.$refs.term.scrollHeight},300)}},watch:{}},R={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"term-frame",style:{height:this.height+"px",position:"relative"}},[t("div",{ref:"term",staticClass:"term",attrs:{id:this.id},domProps:{innerHTML:this._s(this.history)}},[this._v("\n    "+this._s(this.history)+"\n  ")])])},staticRenderFns:[]};var A=n("VU/8")(P,R,!1,function(e){n("3XKM")},null,null).exports,I={name:"ModalProject",props:["list"],components:{},data:function(){return{columns:[{title:"專案",key:"project"}]}},mounted:function(){var e=this;return u()(l.a.mark(function t(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},t,e)}))()},methods:{onRowClick:function(e,t){this.$emit("rowClick",e)}}},M={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"modalProject"}},[t("Table",{attrs:{border:"",columns:this.columns,data:this.list},on:{"on-row-click":this.onRowClick}})],1)},staticRenderFns:[]};var j=n("VU/8")(I,M,!1,function(e){n("2x0r")},null,null).exports,D=!1,U=[{title:"主機",key:"host"},{title:"埠",key:"port"},{title:"帳號",key:"user"},{title:"密碼",key:"password"},{title:"database",key:"database"},{title:"sys_database",key:"sys_database"}],L={name:"ADB",components:{ModalConfig:x,Terminal:A,ModalDatabaseOption:h},data:function(){return{split1:.3,visibleConfig:!1,visibleOption:!1,tabs:[{title:"1",id:1}],tabIndex:1,tabCurr:"1",height:0,project:null,config:{projects:[{project:"BiPOS",package:"com.bipos",folder:"~/Documents/Project/BiPOS2",apk:"/release/BiPOS2-release.apk"},{project:"mECR",package:"com.bethel.v1",folder:"~/react-native/V1/android",apk:"/app/build/outputs/apk/mECR.apk"},{project:"KONE",package:"com.jabezpos.kone",folder:"~/react-native/kone/android",apk:"/app/build/outputs/apk/release/KONE.apk"},{project:"JabezDC",package:"com.jabezdc",folder:"~/react-native/jabezdc/android",apk:"/app/build/outputs/apk/release/JabezDC.apk"}],commands:[{title:"app 專案",icon:"logo-android",expand:!0,children:[{title:"開啟資料夾",cmd:"open {project.folder}"},{title:"安裝專案",cmd:"adb install -r {project.folder}{project.apk}"},{title:"啓動專案",cmd:"adb shell am start {project.package}/{project.package}.MainActivity"},{title:"停止專案",cmd:"adb shell am force-stop {project.package}"},{title:"移除專案",cmd:"adb shell pm uninstall -k {project.package}"}]},{title:"ADB",expand:!0,children:[{title:"reverse(8081)",cmd:"adb reverse tcp:8081 tcp:8081"},{title:"擷取畫面",cmd:"adb shell screencap -p /sdcard/Download/screencap.png && adb pull /sdcard/Download/screencap.png ~/Downloads && open ~/Downloads && adb shell rm /sdcard/Download/screencap.png"}]},{title:"清除終端機",role:"clear"}],database:[{title:"資料庫設定",expand:!0,children:[{title:"正式區",role:"database",port:3306},{title:"測試區",role:"database",port:3306},{title:"77區",role:"database",port:3306}]},{title:"資料庫複製",icon:"md-redo",role:"database-replicate"}],tables:{SYS:["SITES","USERS","USERGROUPS"],BASE:["APLSYS","TMMF","STKNAME","STOCK","SYSCOD","BAS_EMP","BAS_IO","BAS_IOGROUP","BAS_PTYPE","BAS_PUBLIC","BAS_SER","CASHMF","CLEVEL","CODE","DPF_PLU2","DPF_PLU3","DPF_PLU4","DPMF","F_PLU1","F_PLU12","F_PLU2","F_PLU23MF","F_PLU3","F_PLU4","F_TABMF","GPMF","MGUIELEC","MGUIELEC_D","MGUIELEC_H","MGUIELEC_S","PADNAME","PAYMENT","PRN_TYPE","PSERVER","PSERVER_LST","PSERVER_STORE","PRODUCT","PRODUCT_ORD","PRODUCT_RATE","FFDP","FFDPPLU","FFDP_HS","FFPLU","FFRTR","PROMO_H","PROMO_I","SITES_JPC_PARAM","SITES_JPC_PARAM_D","SITES_PARAM","SIZE","BAS_DESC2","BAS_DP"],TRANSACTION:[{tbl:"HTRH",disable:!0,where:"STOCK_NO = '{STOCK_NO}' and TRN_DATE = '{T_DAY}'"},{tbl:"HTRI",disable:!0,where:"STOCK_NO = '{STOCK_NO}' and TRN_DATE = '{T_DAY}'"},{tbl:"POS_H",where:"T_STORE = '{STOCK_NO}' and T_DAY = '{T_DAY}'"},{tbl:"POS_I",where:"T_STORE = '{STOCK_NO}' and T_DAY = '{T_DAY}'"},{tbl:"POS_HM",where:"T_STORE = '{STOCK_NO}' and T_DAY = '{T_DAY}'"}],OPTIONS:["ADCAROUSEL","APPSITEMENU","BARCODE_FMT","BEACONPOS","BEACONTMPLIST","BGPMF","BONUSLOG","BONUSMASTER","BULLETIN_BOARD","COLOR","FINDATA","IMPORT","IITEM","IOAMT_H","IOAMT_I","MAKER","MAKER_C","MTAXH","MTAXI","PACK","POS_E","PREPAIDRULE","QITEM","RECEPTION","RIITEM","RIMP","SCHG_H","SCHG_I","TAKE_H","TAKE_I","TOITEM","TORDER","TRANS_2UBILL","TRANS_EZPAYMENT","TRANS_IPASS","TRANS_IPASS_CR","TRANS_PMS","TRANS_UUPON","VIPMF","VIPMF_LOG"]},sql_var:["STOCK_NO","TM_NO","T_DAY"]}}},mounted:function(){var e=this;return u()(l.a.mark(function t(){var n,r,o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:void 0===(n=localStorage["adb-split-left-width"])&&(n=300),e.split1=1-(document.body.clientWidth-n)/document.body.clientWidth,e.$isElectron,"string"==typeof(r=localStorage["adb-config"])&&r.length>0&&(e.config=JSON.parse(r)),"string"==typeof(r=localStorage["adb-project"])&&r.length>0&&1==(o=e.config.projects.filter(function(e){return e.project==r})).length&&(e.project=o[0]),e.broadcast.$on("on-resize",e.onResize),e.onResize(),e.broadcast.$on("term-finish",e.executeFinish);case 11:case"end":return t.stop()}},t,e)}))()},destroyed:function(){this.broadcast.$off("on-resize",this.onResize),this.broadcast.$off("term-finish",this.executeFinish)},methods:{onMoveEnd:function(){var e=document.querySelector(".left-pane").clientWidth;localStorage["adb-split-left-width"]=e},onResize:function(){var e=document.querySelector(".ivu-tabs").clientHeight,t=document.querySelector(".ivu-tabs-bar").clientHeight;this.height=e-t,document.querySelector(".ivu-tabs-content").style.height=this.height+"px"},onClickIcon:function(){alert("還沒寫，只作測試用，"+this.tabCurr)},onCloseConfig:function(e){void 0!==e&&(localStorage["adb-config"]=s()(e),this.config=e),this.visibleConfig=!1},onCloseDatabaseOption:function(e){if(this.visibleOption=!1,"object"==(void 0===e?"undefined":i()(e))){D=!0;var t={SYS:this.config.tables.SYS,BASE:this.config.tables.BASE};"刪除"!=e.mode&&-1==e.tables.indexOf("交易資料表")||(t.TRANSACTION=this.config.tables.TRANSACTION),"刪除"!=e.mode&&-1==e.tables.indexOf("自訂資料表")||(t.OPTIONS=this.config.tables.OPTIONS),e.tables=t,this.broadcast.$emit("term-database",this.tabCurr,e)}},onSelectChange:function(e){var t=this;if(1!=D)for(var n in void 0===e.children&&("string"==typeof e.cmd&&e.cmd.trim().length>0?e.cmd.indexOf("{project.")>-1?null==this.project?this.projectPicker(function(){l(e.cmd)}):l(e.cmd):c(e.cmd):"string"==typeof e.role&&("clear"==e.role?c(e.role):"database-replicate"==e.role?t.visibleOption=!0:"database"==e.role?t.databasePicker(e):alert("role: "+e.role))),this.config.commands){var r=this.config.commands[n];if("object"==i()(r.children))for(var o=this.config.commands[n].children,a=0;a<o.length;a++){var s=o[a];"object"==i()(s.children)||("boolean"==typeof s.selected?e.nodeKey!=s.nodeKey&&(s.selected=void 0,this.$set(this.config.commands[n].children,a,s)):e.nodeKey==s.nodeKey&&(s.selected=!0,this.$set(this.config.commands[n].children,a,s)))}else"boolean"==typeof r.selected?e.nodeKey!=r.nodeKey&&(r.selected=void 0,this.$set(this.config.commands,n,this.config.commands[n])):e.nodeKey==r.nodeKey&&(r.selected=!0,this.$set(this.config.commands,n,this.config.commands[n]))}function c(e){"object"==i()(window.process)&&(e=e.replace(new RegExp("~/","gm"),"/Users/"+window.process.env.USER+"/")),D=!0,t.broadcast.$emit("term-execute",t.tabCurr,e)}function l(e){for(var n in t.project)"project"!=n&&(e=e.replace(new RegExp("{project."+n+"}","gm"),t.project[n]));c(e)}},projectPicker:function(e){var t=this,n=this;this.$Modal.info({title:"專案清單",width:300,render:function(r){return r(j,{props:{list:n.config.projects},on:{rowClick:function(r){n.project=r,0==t.$isElectron&&(localStorage["adb-project"]=r.project),"function"==typeof e&&e(),n.$Modal.remove()}}})}})},databasePicker:function(e){var t=this,n=!1;this.$Modal.confirm({title:"資料庫設定［"+e.title+"］",width:500,render:function(t){return t(v,{props:{database:e,cols:U},on:{onChange:function(e){n=!0}}})},onOk:function(){1==n&&(localStorage["adb-config"]=s()(t.config))}})},executeFinish:function(){D=!1},onTabRemove:function(e){for(var t=0;t<this.tabs.length;t++)if(this.tabs[t].title==e){t==this.tabs.length-1?this.tabCurr=this.tabs[t-1].title:this.tabCurr=this.tabs[t+1].title,this.tabs.splice(t,1);break}},onTabsAdd:function(){++this.tabIndex,this.tabs.push({title:this.tabIndex.toString(),id:this.tabIndex})},onTabClick:function(e){this.tabCurr=e,console.log("onTabClick: ",e)},renderTreeItem:function(e,t){var n=this,r=(t.root,t.node,t.data),o=[e("span",{class:"ivu-tree-title"+(1==r.selected?" ivu-tree-title-selected":""),on:{click:function(){n.onSelectChange(r)}}},r.title)];return o.unshift(e("Icon",{props:{type:"string"==typeof r.icon?r.icon:void 0===r.children?"ios-paper-outline":1==r.expand?"ios-folder-open":"md-folder"},style:{marginRight:"2px"}})),e("span",{style:{display:"inline-block",width:"100%",marginBottom:"0px"}},o)}}},N={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"stretch","justify-content":"end"},attrs:{id:"app"}},[n("div",{staticStyle:{background:"#2d8cf0",display:"flex","flex-direction":"row","justify-content":"start","align-items":"center"}},[n("div",{staticStyle:{flex:"1","text-align":"left",color:"white",padding:"5px"}},[e._v("\n      "+e._s("指令集")+"\n      "),null!=e.project?n("span",{staticStyle:{cursor:"pointer"},on:{click:e.projectPicker}},[e._v("\n        "+e._s("["+e.project.project+"]")+"\n      ")]):e._e()]),e._v(" "),n("Icon",{staticClass:"btn",attrs:{type:"md-cog"},nativeOn:{click:function(t){e.visibleConfig=!0}}}),e._v(" "),n("Icon",{staticClass:"btn",attrs:{type:"md-close"},nativeOn:{click:function(t){return e.onClickIcon(t)}}})],1),e._v(" "),n("div",{staticStyle:{flex:"1"}},[n("Split",{on:{"on-move-end":e.onMoveEnd},model:{value:e.split1,callback:function(t){e.split1=t},expression:"split1"}},[n("div",{staticClass:"demo-split-pane",staticStyle:{"z-index":"1","overflow-x":"hidden"},attrs:{slot:"left",id:"left"},slot:"left"},[n("Tree",{staticStyle:{"z-index":"-1"},attrs:{data:e.config.commands.concat(e.config.database),render:e.renderTreeItem},on:{"on-select-change":e.onSelectChange}})],1),e._v(" "),n("div",{staticClass:"demo-split-pane",staticStyle:{"z-index":"1","overflow-x":"hidden"},attrs:{slot:"right",id:"right"},slot:"right"},[n("Tabs",{attrs:{type:"card"},on:{"on-tab-remove":e.onTabRemove,"on-click":e.onTabClick}},[e._l(e.tabs,function(t,r){return n("TabPane",{key:t.id,attrs:{closable:0!=r,name:t.title,label:"Shell "+t.title}},[n("Terminal",{ref:"term-"+t.title,refInFor:!0,attrs:{height:e.height,title:t.title}})],1)}),e._v(" "),n("Button",{attrs:{slot:"extra",size:"small"},on:{click:e.onTabsAdd},slot:"extra"},[e._v("增加")])],2)],1)])],1),e._v(" "),n("ModalConfig",{attrs:{visible:e.visibleConfig,config:0==e.visibleConfig?void 0:e.config},on:{"on-close":e.onCloseConfig}}),e._v(" "),n("ModalDatabaseOption",{attrs:{visible:e.visibleOption,config:0==e.visibleOption?void 0:e.config},on:{"on-close":e.onCloseDatabaseOption}})],1)},staticRenderFns:[]};var $=n("VU/8")(L,N,!1,function(e){n("Qp2+")},null,null).exports,F=n("BTaQ"),B=n.n(F),H=(n("+skl"),n("4lpq"));r.default.use(B.a,{locale:H.a}),r.default.config.productionTip=!1,r.default.prototype.broadcast=new r.default,r.default.prototype.$isElectron=navigator.userAgent.indexOf("Electron")>-1,new r.default({el:"#app",components:{ADB:$},template:"<ADB />",mounted:function(){var e=this;window.onresize=function(){e.broadcast.$emit("on-resize")}}})},zql2:function(e,t){}},["twTI"]);
//# sourceMappingURL=adb.112e31215123a6716d48.js.map